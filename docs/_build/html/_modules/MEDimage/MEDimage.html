<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MEDimage.MEDimage &mdash; MEDimage  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> MEDimage
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">MEDimage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../FAQs.html">FAQs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MEDimage</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Module code</a> &raquo;</li>
      <li>MEDimage.MEDimage</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for MEDimage.MEDimage</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">json</span> <span class="kn">import</span> <span class="n">dump</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">nibabel</span> <span class="k">as</span> <span class="nn">nib</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpyencoder</span> <span class="kn">import</span> <span class="n">NumpyEncoder</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="kn">from</span> <span class="nn">MEDimage.processing.compute_suv_map</span> <span class="kn">import</span> <span class="n">compute_suv_map</span>
<span class="kn">from</span> <span class="nn">MEDimage.utils.image_volume_obj</span> <span class="kn">import</span> <span class="n">image_volume_obj</span>

<span class="kn">from</span> <span class="nn">.utils.imref</span> <span class="kn">import</span> <span class="n">imref3d</span>
<span class="kn">from</span> <span class="nn">.utils.json_utils</span> <span class="kn">import</span> <span class="n">load_json</span>


<div class="viewcode-block" id="MEDimage"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage">[docs]</a><span class="k">class</span> <span class="nc">MEDimage</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Organizes all scan data (patientID, imaging data, scan type...). </span>

<span class="sd">    Attributes:</span>
<span class="sd">        patientID (str): Patient ID.</span>
<span class="sd">        type (str): Scan type (MRscan, CTscan...).</span>
<span class="sd">        format (str): Scan file format. Either &#39;npy&#39; or &#39;nifti&#39;.</span>
<span class="sd">        dicomH (pydicom.dataset.FileDataset): DICOM header.</span>
<span class="sd">        scan (MEDimage.scan): Instance of MEDimage.scan inner class.</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="MEDimage.__init__"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">MEDimg</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Constructor of the MEDimage class</span>

<span class="sd">        Args:</span>
<span class="sd">            MEDimg(MEDimage): A MEDimage class instance.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">patientID</span> <span class="o">=</span> <span class="n">MEDimg</span><span class="o">.</span><span class="n">patientID</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">patientID</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">MEDimg</span><span class="o">.</span><span class="n">type</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">series_description</span> <span class="o">=</span> <span class="n">MEDimg</span><span class="o">.</span><span class="n">series_description</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">series_description</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="n">MEDimg</span><span class="o">.</span><span class="n">format</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dicomH</span> <span class="o">=</span> <span class="n">MEDimg</span><span class="o">.</span><span class="n">dicomH</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dicomH</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scan</span> <span class="o">=</span> <span class="n">MEDimg</span><span class="o">.</span><span class="n">scan</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">MEDimg</span><span class="o">.</span><span class="n">params</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Params</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radiomics</span> <span class="o">=</span> <span class="n">MEDimg</span><span class="o">.</span><span class="n">radiomics</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radiomics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Radiomics</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">skip</span> <span class="o">=</span> <span class="kc">False</span></div>

    <span class="k">def</span> <span class="nf">__init_process_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">im_params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Initializes the processing params from a given Dict.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            im_params(Dict): Dictionary of different processing params.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;CTscan&#39;</span> <span class="ow">and</span> <span class="s1">&#39;imParamCT&#39;</span> <span class="ow">in</span> <span class="n">im_params</span><span class="p">:</span>
            <span class="n">im_params</span> <span class="o">=</span> <span class="n">im_params</span><span class="p">[</span><span class="s1">&#39;imParamCT&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;MRscan&#39;</span> <span class="ow">and</span> <span class="s1">&#39;imParamMR&#39;</span> <span class="ow">in</span> <span class="n">im_params</span><span class="p">:</span>
            <span class="n">im_params</span> <span class="o">=</span> <span class="n">im_params</span><span class="p">[</span><span class="s1">&#39;imParamMR&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;PTscan&#39;</span> <span class="ow">and</span> <span class="s1">&#39;imParamPET&#39;</span> <span class="ow">in</span> <span class="n">im_params</span><span class="p">:</span>
            <span class="n">im_params</span> <span class="o">=</span> <span class="n">im_params</span><span class="p">[</span><span class="s1">&#39;imParamPET&#39;</span><span class="p">]</span>
        
        <span class="c1"># re-segmentation range processing</span>
        <span class="k">if</span><span class="p">(</span><span class="n">im_params</span><span class="p">[</span><span class="s1">&#39;reSeg&#39;</span><span class="p">][</span><span class="s1">&#39;range&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">im_params</span><span class="p">[</span><span class="s1">&#39;reSeg&#39;</span><span class="p">][</span><span class="s1">&#39;range&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;inf&quot;</span><span class="p">):</span>
            <span class="n">im_params</span><span class="p">[</span><span class="s1">&#39;reSeg&#39;</span><span class="p">][</span><span class="s1">&#39;range&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

        <span class="c1"># 10 voxels in all three dimensions are added to the smallest</span>
        <span class="c1"># bounding box. This setting is used to speed up interpolation</span>
        <span class="c1"># processes (mostly) prior to the computation of radiomics</span>
        <span class="c1"># features. Optional argument in the function computeRadiomics.</span>
        <span class="n">box_string</span> <span class="o">=</span> <span class="s1">&#39;box10&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;compute_diag_features&#39;</span> <span class="ow">in</span> <span class="n">im_params</span><span class="p">:</span>
            <span class="n">compute_diag_features</span> <span class="o">=</span> <span class="n">im_params</span><span class="p">[</span><span class="s1">&#39;compute_diag_features&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">compute_diag_features</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">compute_diag_features</span><span class="p">:</span>  <span class="c1"># If compute_diag_features is true.</span>
            <span class="n">box_string</span> <span class="o">=</span> <span class="s1">&#39;full&#39;</span>  <span class="c1"># This is required for proper comparison.</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">box_string</span> <span class="o">=</span> <span class="n">box_string</span>

        <span class="c1"># get default scan parameters from im_param_scan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">filter</span> <span class="o">=</span> <span class="n">im_params</span><span class="p">[</span><span class="s1">&#39;filter&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">scale_non_text</span> <span class="o">=</span> <span class="n">im_params</span><span class="p">[</span><span class="s1">&#39;interp&#39;</span><span class="p">][</span><span class="s1">&#39;scale_non_text&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">vol_interp</span>  <span class="o">=</span> <span class="n">im_params</span><span class="p">[</span><span class="s1">&#39;interp&#39;</span><span class="p">][</span><span class="s1">&#39;vol_interp&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">roi_interp</span> <span class="o">=</span> <span class="n">im_params</span><span class="p">[</span><span class="s1">&#39;interp&#39;</span><span class="p">][</span><span class="s1">&#39;roi_interp&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">gl_round</span> <span class="o">=</span> <span class="n">im_params</span><span class="p">[</span><span class="s1">&#39;interp&#39;</span><span class="p">][</span><span class="s1">&#39;gl_round&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">roi_pv</span>  <span class="o">=</span> <span class="n">im_params</span><span class="p">[</span><span class="s1">&#39;interp&#39;</span><span class="p">][</span><span class="s1">&#39;roi_pv&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">im_range</span> <span class="o">=</span> <span class="n">im_params</span><span class="p">[</span><span class="s1">&#39;reSeg&#39;</span><span class="p">][</span><span class="s1">&#39;range&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;range&#39;</span> <span class="ow">in</span> <span class="n">im_params</span><span class="p">[</span><span class="s1">&#39;reSeg&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">outliers</span> <span class="o">=</span> <span class="n">im_params</span><span class="p">[</span><span class="s1">&#39;reSeg&#39;</span><span class="p">][</span><span class="s1">&#39;outliers&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">ih</span> <span class="o">=</span> <span class="n">im_params</span><span class="p">[</span><span class="s1">&#39;discretisation&#39;</span><span class="p">][</span><span class="s1">&#39;IH&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">ivh</span> <span class="o">=</span> <span class="n">im_params</span><span class="p">[</span><span class="s1">&#39;discretisation&#39;</span><span class="p">][</span><span class="s1">&#39;IVH&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">scale_text</span> <span class="o">=</span> <span class="n">im_params</span><span class="p">[</span><span class="s1">&#39;interp&#39;</span><span class="p">][</span><span class="s1">&#39;scale_text&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">algo</span> <span class="o">=</span> <span class="n">im_params</span><span class="p">[</span><span class="s1">&#39;discretisation&#39;</span><span class="p">][</span><span class="s1">&#39;texture&#39;</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">gray_levels</span> <span class="o">=</span> <span class="n">im_params</span><span class="p">[</span><span class="s1">&#39;discretisation&#39;</span><span class="p">][</span><span class="s1">&#39;texture&#39;</span><span class="p">][</span><span class="s1">&#39;val&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">im_type</span> <span class="o">=</span> <span class="n">im_params</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>

        <span class="c1"># Variable used to determine if there is &#39;arbitrary&#39; (e.g., MRI)</span>
        <span class="c1"># or &#39;definite&#39; (e.g., CT) intensities.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">intensity</span> <span class="o">=</span> <span class="n">im_params</span><span class="p">[</span><span class="s1">&#39;intensity&#39;</span><span class="p">]</span>
        <span class="c1"># Voxels dimension</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">n_scale</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">scale_text</span><span class="p">)</span>
        <span class="c1"># Setting up discretisation params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">n_algo</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">algo</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">n_gl</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">gray_levels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">n_exp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">n_scale</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">n_algo</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">n_gl</span>

        <span class="c1"># Setting up user_set_min_value</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">im_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">im_range</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">im_range</span><span class="p">:</span>
            <span class="n">user_set_min_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">im_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">user_set_min_value</span> <span class="o">==</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                <span class="c1"># In case no re-seg im_range is defined for the FBS algorithm,</span>
                <span class="c1"># the minimum value of ROI will be used (not recommended).</span>
                <span class="n">user_set_min_value</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># In case no re-seg im_range is defined for the FBS algorithm,</span>
            <span class="c1"># the minimum value of ROI will be used (not recommended).</span>
            <span class="n">user_set_min_value</span> <span class="o">=</span> <span class="p">[]</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">user_set_min_value</span> <span class="o">=</span> <span class="n">user_set_min_value</span>

        <span class="c1"># box_string argument is optional. If not present, we use the full box.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">box_string</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">box_string</span> <span class="o">=</span> <span class="s1">&#39;full&#39;</span>
        
    <span class="k">def</span> <span class="nf">__init_filter_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Initializes the filtering params from a given Dict.</span>

<span class="sd">        Args:</span>
<span class="sd">            filter_params(Dict): Dictionary of the filtering parameters.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;imParamFilter&#39;</span> <span class="ow">in</span> <span class="n">filter_params</span><span class="p">:</span>
            <span class="n">filter_params</span> <span class="o">=</span> <span class="n">filter_params</span><span class="p">[</span><span class="s1">&#39;imParamFilter&#39;</span><span class="p">]</span>
        
        <span class="c1"># set filter type</span>
        <span class="k">if</span> <span class="s1">&#39;filter_type&#39;</span> <span class="ow">in</span> <span class="n">filter_params</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">filter_type</span> <span class="o">=</span> <span class="n">filter_params</span><span class="p">[</span><span class="s1">&#39;filter_type&#39;</span><span class="p">]</span>

        <span class="c1"># mean filter params</span>
        <span class="k">if</span> <span class="s1">&#39;mean&#39;</span> <span class="ow">in</span> <span class="n">filter_params</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">init_from_json</span><span class="p">(</span><span class="n">filter_params</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">])</span>

        <span class="c1"># log filter params</span>
        <span class="k">if</span> <span class="s1">&#39;log&#39;</span> <span class="ow">in</span> <span class="n">filter_params</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">init_from_json</span><span class="p">(</span><span class="n">filter_params</span><span class="p">[</span><span class="s1">&#39;log&#39;</span><span class="p">])</span>

        <span class="c1"># laws filter params</span>
        <span class="k">if</span> <span class="s1">&#39;laws&#39;</span> <span class="ow">in</span> <span class="n">filter_params</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">laws</span><span class="o">.</span><span class="n">init_from_json</span><span class="p">(</span><span class="n">filter_params</span><span class="p">[</span><span class="s1">&#39;laws&#39;</span><span class="p">])</span>

        <span class="c1"># gabor filter params</span>
        <span class="k">if</span> <span class="s1">&#39;gabor&#39;</span> <span class="ow">in</span> <span class="n">filter_params</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">gabor</span><span class="o">.</span><span class="n">init_from_json</span><span class="p">(</span><span class="n">filter_params</span><span class="p">[</span><span class="s1">&#39;gabor&#39;</span><span class="p">])</span>

        <span class="c1"># wavelet filter params</span>
        <span class="k">if</span> <span class="s1">&#39;wavelet&#39;</span> <span class="ow">in</span> <span class="n">filter_params</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">filter</span><span class="o">.</span><span class="n">wavelet</span><span class="o">.</span><span class="n">init_from_json</span><span class="p">(</span><span class="n">filter_params</span><span class="p">[</span><span class="s1">&#39;wavelet&#39;</span><span class="p">])</span>

<div class="viewcode-block" id="MEDimage.init_params"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.init_params">[docs]</a>    <span class="k">def</span> <span class="nf">init_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">im_param_scan</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Initializes the Params class from a dictionary.</span>

<span class="sd">        Args:</span>
<span class="sd">            im_param_scan(Dict): Dictionary of different processing, extraction and filtering params.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># get default scan parameters from im_param_scan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__init_process_params</span><span class="p">(</span><span class="n">im_param_scan</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__init_filter_params</span><span class="p">(</span><span class="n">im_param_scan</span><span class="p">[</span><span class="s1">&#39;imParamFilter&#39;</span><span class="p">])</span>

            <span class="c1"># compute suv map for PT scans</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;PTscan&#39;</span><span class="p">:</span>
                <span class="n">_compute_suv_map</span> <span class="o">=</span> <span class="n">im_param_scan</span><span class="p">[</span><span class="s1">&#39;computeSUVmap&#39;</span><span class="p">]</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="n">_compute_suv_map</span> <span class="o">=</span> <span class="kc">False</span>
            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;PTscan&#39;</span> <span class="ow">and</span> <span class="n">_compute_suv_map</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">volume</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">compute_suv_map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">volume</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dicomH</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span> <span class="p">:</span>
                    <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ERROR COMPUTING SUV MAP - SOME FEATURES WILL BE INVALID: </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">skip</span> <span class="o">=</span> <span class="kc">True</span>
            
            <span class="c1"># initialize radiomics structure</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">im_param_scan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">scale_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">ih_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">ivh_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> ERROR IN INITIALIZATION OF RADIOMICS FEATURE COMPUTATION</span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skip</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="MEDimage.init_ntf_calculation"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.init_ntf_calculation">[docs]</a>    <span class="k">def</span> <span class="nf">init_ntf_calculation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vol_obj</span><span class="p">:</span> <span class="n">image_volume_obj</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes all the computation parameters for non-texture features  as well as the results dict.</span>

<span class="sd">        Args:</span>
<span class="sd">            vol_obj(image_volume_obj): Imaging volume.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">scale_non_text</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># In case the user chose to not interpolate</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">scale_non_text</span> <span class="o">=</span> <span class="p">[</span>
                                        <span class="n">vol_obj</span><span class="o">.</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">PixelExtentInWorldX</span><span class="p">,</span>
                                        <span class="n">vol_obj</span><span class="o">.</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">PixelExtentInWorldY</span><span class="p">,</span>
                                        <span class="n">vol_obj</span><span class="o">.</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">PixelExtentInWorldZ</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">scale_non_text</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="c1"># In case not interpolation is performed in</span>
                    <span class="c1"># the slice direction (e.g. 2D case)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">scale_non_text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">scale_non_text</span> <span class="o">+</span> \
                        <span class="p">[</span><span class="n">vol_obj</span><span class="o">.</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">PixelExtentInWorldZ</span><span class="p">]</span>

            <span class="c1"># Scale name</span>
            <span class="c1"># Always isotropic resampling, so the first entry is ok.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">scale_name</span> <span class="o">=</span> <span class="s1">&#39;scale&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">scale_non_text</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;dot&#39;</span><span class="p">)</span>

            <span class="c1"># IH name</span>
            <span class="n">ih_val_name</span> <span class="o">=</span> <span class="s1">&#39;bin&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">ih</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">]))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;dot&#39;</span><span class="p">)</span>

            <span class="c1"># The minimum value defines the computation.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">ih</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;FBS&#39;</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">user_set_min_value</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">user_set_min_value</span><span class="p">:</span>
                    <span class="n">min_val_name</span> <span class="o">=</span> <span class="s1">&#39;_min&#39;</span> <span class="o">+</span> \
                        <span class="p">((</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">user_set_min_value</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;dot&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Otherwise, minimum value of ROI will be used (not recommended),</span>
                    <span class="c1"># so no need to report it.</span>
                    <span class="n">min_val_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">min_val_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">ih_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">scale_name</span> <span class="o">+</span> \
                                            <span class="s1">&#39;_algo&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">ih</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">+</span> \
                                            <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ih_val_name</span> <span class="o">+</span> <span class="n">min_val_name</span>

            <span class="c1"># IVH name</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">ivh</span><span class="p">:</span>  <span class="c1"># CT case</span>
                <span class="n">ivh_algo_name</span> <span class="o">=</span> <span class="s1">&#39;algoNone&#39;</span>
                <span class="n">ivh_val_name</span> <span class="o">=</span> <span class="s1">&#39;bin1&#39;</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">im_range</span><span class="p">:</span>  <span class="c1"># The im_range defines the computation.</span>
                    <span class="n">min_val_name</span> <span class="o">=</span> <span class="p">((</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">im_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                        <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;dot&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
                    <span class="n">max_val_name</span> <span class="o">=</span> <span class="p">((</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">im_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                        <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;dot&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
                    <span class="n">range_name</span> <span class="o">=</span> <span class="s1">&#39;_min&#39;</span> <span class="o">+</span> <span class="n">min_val_name</span> <span class="o">+</span> <span class="s1">&#39;_max&#39;</span> <span class="o">+</span> <span class="n">max_val_name</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">range_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ivh_algo_name</span> <span class="o">=</span> <span class="s1">&#39;algo&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">ivh</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
                <span class="n">ivh_val_name</span> <span class="o">=</span> <span class="s1">&#39;bin&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">ivh</span><span class="p">[</span><span class="s1">&#39;val&#39;</span><span class="p">]))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;dot&#39;</span><span class="p">)</span>
                <span class="c1"># The im_range defines the computation.</span>
                <span class="k">if</span> <span class="s1">&#39;type&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">ivh</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">ivh</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;FBS&#39;</span><span class="p">)</span> <span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">im_range</span><span class="p">:</span>
                        <span class="n">min_val_name</span> <span class="o">=</span> <span class="p">((</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">im_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                            <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;dot&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
                        <span class="n">max_val_name</span> <span class="o">=</span> <span class="p">((</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">im_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                            <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;dot&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">max_val_name</span> <span class="o">==</span> <span class="s1">&#39;inf&#39;</span><span class="p">:</span>
                            <span class="c1"># In this case, the maximum value of the ROI is used,</span>
                            <span class="c1"># so no need to report it.</span>
                            <span class="n">range_name</span> <span class="o">=</span> <span class="s1">&#39;_min&#39;</span> <span class="o">+</span> <span class="n">min_val_name</span>
                        <span class="k">elif</span> <span class="n">min_val_name</span> <span class="o">==</span> <span class="s1">&#39;-inf&#39;</span><span class="p">:</span>
                            <span class="c1"># In this case, the minimum value of the ROI is used,</span>
                            <span class="c1"># so no need to report it.</span>
                            <span class="n">range_name</span> <span class="o">=</span> <span class="s1">&#39;_max&#39;</span> <span class="o">+</span> <span class="n">max_val_name</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">range_name</span> <span class="o">=</span> <span class="s1">&#39;_min&#39;</span> <span class="o">+</span> <span class="n">min_val_name</span> <span class="o">+</span> <span class="s1">&#39;_max&#39;</span> <span class="o">+</span> <span class="n">max_val_name</span>
                    <span class="k">else</span><span class="p">:</span>  <span class="c1"># min-max of ROI will be used, no need to report it.</span>
                        <span class="n">range_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># min-max of ROI will be used, no need to report it.</span>
                    <span class="n">range_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">ivh_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">scale_name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ivh_algo_name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">ivh_val_name</span> <span class="o">+</span> <span class="n">range_name</span>

            <span class="c1"># Now initialize the attribute that will hold the computation results</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">update</span><span class="p">({</span> 
                            <span class="s1">&#39;morph_3D&#39;</span><span class="p">:</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">scale_name</span><span class="p">:</span> <span class="p">{}},</span>
                            <span class="s1">&#39;locInt_3D&#39;</span><span class="p">:</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">scale_name</span><span class="p">:</span> <span class="p">{}},</span>
                            <span class="s1">&#39;stats_3D&#39;</span><span class="p">:</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">scale_name</span><span class="p">:</span> <span class="p">{}},</span>
                            <span class="s1">&#39;intHist_3D&#39;</span><span class="p">:</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">ih_name</span><span class="p">:</span> <span class="p">{}},</span>
                            <span class="s1">&#39;intVolHist_3D&#39;</span><span class="p">:</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">ivh_name</span><span class="p">:</span> <span class="p">{}}</span> 
                            <span class="p">})</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> PROBLEM WITH PRE-PROCESSING OF FEATURES IN init_ntf_calculation(): </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">update</span><span class="p">(</span>
                    <span class="p">{(</span><span class="s1">&#39;scale&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">scale_non_text</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;dot&#39;</span><span class="p">)):</span> <span class="s1">&#39;ERROR_PROCESSING&#39;</span><span class="p">})</span></div>

<div class="viewcode-block" id="MEDimage.init_tf_calculation"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.init_tf_calculation">[docs]</a>    <span class="k">def</span> <span class="nf">init_tf_calculation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">algo</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="n">gl</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span><span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes all the computation parameters for the texture-features as well as the results dict.</span>

<span class="sd">        Args:</span>
<span class="sd">            algo(int): Discretisation algorithms index.</span>
<span class="sd">            gl(int): gray-level index.</span>
<span class="sd">            scale(int): scale-text index.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check glcm merge method</span>
        <span class="n">glcm_merge_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">glcm</span><span class="o">.</span><span class="n">merge_method</span>
        <span class="k">if</span> <span class="n">glcm_merge_method</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">glcm_merge_method</span> <span class="o">==</span> <span class="s1">&#39;average&#39;</span><span class="p">:</span>
                <span class="n">glcm_merge_method</span> <span class="o">=</span> <span class="s1">&#39;_avg&#39;</span>
            <span class="k">elif</span> <span class="n">glcm_merge_method</span> <span class="o">==</span> <span class="s1">&#39;vol_merge&#39;</span><span class="p">:</span>
                <span class="n">glcm_merge_method</span> <span class="o">=</span> <span class="s1">&#39;_comb&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">error_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">glcm_merge_method</span><span class="si">}</span><span class="s2"> Method not supported in glcm computation, </span><span class="se">\</span>
<span class="s2">                    only &#39;average&#39; or &#39;vol_merge&#39; are supported. </span><span class="se">\</span>
<span class="s2">                    Radiomics will be saved without any specific merge method.&quot;</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>

        <span class="c1"># check glrlm merge method</span>
        <span class="n">glrlm_merge_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">glrlm</span><span class="o">.</span><span class="n">merge_method</span>
        <span class="k">if</span> <span class="n">glrlm_merge_method</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">glrlm_merge_method</span> <span class="o">==</span> <span class="s1">&#39;average&#39;</span><span class="p">:</span>
                <span class="n">glrlm_merge_method</span> <span class="o">=</span> <span class="s1">&#39;_avg&#39;</span>
            <span class="k">elif</span> <span class="n">glrlm_merge_method</span> <span class="o">==</span> <span class="s1">&#39;vol_merge&#39;</span><span class="p">:</span>
                <span class="n">glrlm_merge_method</span> <span class="o">=</span> <span class="s1">&#39;_comb&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">error_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">glcm_merge_method</span><span class="si">}</span><span class="s2"> Method not supported in glrlm computation, </span><span class="se">\</span>
<span class="s2">                    only &#39;average&#39; or &#39;vol_merge&#39; are supported. </span><span class="se">\</span>
<span class="s2">                    Radiomics will be saved without any specific merge method&quot;</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">error_msg</span><span class="p">)</span>
        <span class="c1"># set texture features names and updates radiomics dict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">name_text_types</span> <span class="o">=</span> <span class="p">[</span>
                                <span class="s1">&#39;glcm_3D&#39;</span> <span class="o">+</span> <span class="n">glcm_merge_method</span><span class="p">,</span> 
                                <span class="s1">&#39;glrlm_3D&#39;</span> <span class="o">+</span> <span class="n">glrlm_merge_method</span><span class="p">,</span> 
                                <span class="s1">&#39;glszm_3D&#39;</span><span class="p">,</span> 
                                <span class="s1">&#39;gldzm_3D&#39;</span><span class="p">,</span> 
                                <span class="s1">&#39;ngtdm_3D&#39;</span><span class="p">,</span> 
                                <span class="s1">&#39;ngldm_3D&#39;</span><span class="p">]</span>
        <span class="n">n_text_types</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">name_text_types</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="s1">&#39;texture&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">image</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;texture&#39;</span><span class="p">:</span> <span class="p">{}})</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_text_types</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">image</span><span class="p">[</span><span class="s1">&#39;texture&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">name_text_types</span><span class="p">[</span><span class="n">t</span><span class="p">]:</span> <span class="p">{}})</span>

        <span class="c1"># scale name</span>
        <span class="c1"># Always isotropic resampling, so the first entry is ok.</span>
        <span class="n">scale_name</span> <span class="o">=</span> <span class="s1">&#39;scale&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">scale_text</span><span class="p">[</span><span class="n">scale</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;dot&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="p">,</span> <span class="s2">&quot;scale_name&quot;</span><span class="p">):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="p">,</span> <span class="s1">&#39;scale_name&#39;</span><span class="p">,</span> <span class="n">scale_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">scale_name</span> <span class="o">=</span> <span class="n">scale_name</span>

        <span class="c1"># Discretisation name</span>
        <span class="n">gray_levels_name</span> <span class="o">=</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">gray_levels</span><span class="p">[</span><span class="n">algo</span><span class="p">][</span><span class="n">gl</span><span class="p">]))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;dot&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;FBS&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">algo</span><span class="p">[</span><span class="n">algo</span><span class="p">]:</span>  <span class="c1"># The minimum value defines the computation.</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">user_set_min_value</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">user_set_min_value</span><span class="p">:</span>
                <span class="n">min_val_name</span> <span class="o">=</span> <span class="s1">&#39;_min&#39;</span> <span class="o">+</span> <span class="p">((</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">user_set_min_value</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;dot&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Otherwise, minimum value of ROI will be used (not recommended),</span>
                <span class="c1"># so no need to report it.</span>
                <span class="n">min_val_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">min_val_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="s1">&#39;equal&#39;</span><span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">algo</span><span class="p">[</span><span class="n">algo</span><span class="p">]:</span>
            <span class="c1"># The number of gray-levels used for equalization is currently</span>
            <span class="c1"># hard-coded to 64 in equalization.m</span>
            <span class="n">discretisation_name</span> <span class="o">=</span> <span class="s1">&#39;algo&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">algo</span><span class="p">[</span><span class="n">algo</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;256_bin&#39;</span> <span class="o">+</span> <span class="n">gray_levels_name</span> <span class="o">+</span> <span class="n">min_val_name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">discretisation_name</span> <span class="o">=</span> <span class="s1">&#39;algo&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">algo</span><span class="p">[</span><span class="n">algo</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_bin&#39;</span> <span class="o">+</span> <span class="n">gray_levels_name</span> <span class="o">+</span> <span class="n">min_val_name</span>

        <span class="c1"># Processing full name</span>
        <span class="n">processing_name</span> <span class="o">=</span> <span class="n">scale_name</span> <span class="o">+</span> <span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">discretisation_name</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="p">,</span> <span class="s2">&quot;processing_name&quot;</span><span class="p">):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="p">,</span> <span class="s1">&#39;processing_name&#39;</span><span class="p">,</span> <span class="n">processing_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">processing_name</span> <span class="o">=</span> <span class="n">processing_name</span></div>

<div class="viewcode-block" id="MEDimage.init_from_nifti"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.init_from_nifti">[docs]</a>    <span class="k">def</span> <span class="nf">init_from_nifti</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nifti_image_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Initializes the MEDimage class using a NIfTI file.</span>

<span class="sd">        Args:</span>
<span class="sd">            nifti_image_path (Path): NIfTI file path.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">patientID</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nifti_image_path</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">nifti_image_path</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s2">&quot;nifti&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">set_orientation</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;Axial&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">set_patientPosition</span><span class="p">(</span><span class="n">patientPosition</span><span class="o">=</span><span class="s2">&quot;HFS&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">ROI</span><span class="o">.</span><span class="n">get_roi_from_path</span><span class="p">(</span><span class="n">roi_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">nifti_image_path</span><span class="p">),</span> 
                                        <span class="nb">id</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">nifti_image_path</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">volume</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">nifti_image_path</span><span class="p">)</span><span class="o">.</span><span class="n">get_fdata</span><span class="p">()</span>
        <span class="c1"># RAS to LPS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">volume</span><span class="o">.</span><span class="n">convert_to_LPS</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">volume</span><span class="o">.</span><span class="n">scan_rot</span> <span class="o">=</span> <span class="kc">None</span></div>
    
<div class="viewcode-block" id="MEDimage.update_radiomics"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.update_radiomics">[docs]</a>    <span class="k">def</span> <span class="nf">update_radiomics</span><span class="p">(</span>
                        <span class="bp">self</span><span class="p">,</span> <span class="n">int_vol_hist_features</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{},</span> 
                        <span class="n">morph_features</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">loc_int_features</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{},</span> 
                        <span class="n">stats_features</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">int_hist_features</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{},</span>
                        <span class="n">glcm_features</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">glrlm_features</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{},</span>
                        <span class="n">glszm_features</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">gldzm_features</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{},</span> 
                        <span class="n">ngtdm_features</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">ngldm_features</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="p">{})</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Updates the results attribute with the extracted features.</span>

<span class="sd">        Args:</span>
<span class="sd">            int_vol_hist_features(Dict, optional): Dictionary of the intensity volume histogram features.</span>
<span class="sd">            morph_features(Dict, optional): Dictionary of the morphological features.</span>
<span class="sd">            loc_int_features(Dict, optional): Dictionary of the intensity local intensity features.</span>
<span class="sd">            stats_features(Dict, optional): Dictionary of the statistical features.</span>
<span class="sd">            int_hist_features(Dict, optional): Dictionary of the intensity histogram features.</span>
<span class="sd">            glcm_features(Dict, optional): Dictionary of the GLCM features.</span>
<span class="sd">            glrlm_features(Dict, optional): Dictionary of the GLRLM features.</span>
<span class="sd">            glszm_features(Dict, optional): Dictionary of the GLSZM features.</span>
<span class="sd">            gldzm_features(Dict, optional): Dictionary of the GLDZM features.</span>
<span class="sd">            ngtdm_features(Dict, optional): Dictionary of the NGTDM features.</span>
<span class="sd">            ngldm_features(Dict, optional): Dictionary of the NGLDM features.</span>
<span class="sd">        Returns:</span>
<span class="sd">            None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check glcm merge method</span>
        <span class="n">glcm_merge_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">glcm</span><span class="o">.</span><span class="n">merge_method</span>
        <span class="k">if</span> <span class="n">glcm_merge_method</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">glcm_merge_method</span> <span class="o">==</span> <span class="s1">&#39;average&#39;</span><span class="p">:</span>
                <span class="n">glcm_merge_method</span> <span class="o">=</span> <span class="s1">&#39;_avg&#39;</span>
            <span class="k">elif</span> <span class="n">glcm_merge_method</span> <span class="o">==</span> <span class="s1">&#39;vol_merge&#39;</span><span class="p">:</span>
                <span class="n">glcm_merge_method</span> <span class="o">=</span> <span class="s1">&#39;_comb&#39;</span>

        <span class="c1"># check glrlm merge method</span>
        <span class="n">glrlm_merge_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">glrlm</span><span class="o">.</span><span class="n">merge_method</span>
        <span class="k">if</span> <span class="n">glrlm_merge_method</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">glrlm_merge_method</span> <span class="o">==</span> <span class="s1">&#39;average&#39;</span><span class="p">:</span>
                <span class="n">glrlm_merge_method</span> <span class="o">=</span> <span class="s1">&#39;_avg&#39;</span>
            <span class="k">elif</span> <span class="n">glrlm_merge_method</span> <span class="o">==</span> <span class="s1">&#39;vol_merge&#39;</span><span class="p">:</span>
                <span class="n">glrlm_merge_method</span> <span class="o">=</span> <span class="s1">&#39;_comb&#39;</span>

        <span class="c1"># Non-texture Features</span>
        <span class="k">if</span> <span class="n">int_vol_hist_features</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">image</span><span class="p">[</span><span class="s1">&#39;intVolHist_3D&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">ivh_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">int_vol_hist_features</span>
        <span class="k">if</span> <span class="n">morph_features</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">image</span><span class="p">[</span><span class="s1">&#39;morph_3D&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">scale_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">morph_features</span>
        <span class="k">if</span> <span class="n">loc_int_features</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">image</span><span class="p">[</span><span class="s1">&#39;locInt_3D&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">scale_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">loc_int_features</span>
        <span class="k">if</span> <span class="n">stats_features</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">image</span><span class="p">[</span><span class="s1">&#39;stats_3D&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">scale_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">stats_features</span>
        <span class="k">if</span> <span class="n">int_hist_features</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">image</span><span class="p">[</span><span class="s1">&#39;intHist_3D&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">ih_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">int_hist_features</span>
        
        <span class="c1"># Texture Features</span>
        <span class="k">if</span> <span class="n">glcm_features</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">image</span><span class="p">[</span><span class="s1">&#39;texture&#39;</span><span class="p">][</span>
                <span class="s1">&#39;glcm_3D&#39;</span> <span class="o">+</span> <span class="n">glcm_merge_method</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">processing_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">glcm_features</span>
        <span class="k">if</span> <span class="n">glrlm_features</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">image</span><span class="p">[</span><span class="s1">&#39;texture&#39;</span><span class="p">][</span>
                <span class="s1">&#39;glrlm_3D&#39;</span> <span class="o">+</span> <span class="n">glrlm_merge_method</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">processing_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">glrlm_features</span>
        <span class="k">if</span> <span class="n">glszm_features</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">image</span><span class="p">[</span><span class="s1">&#39;texture&#39;</span><span class="p">][</span><span class="s1">&#39;glszm_3D&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">processing_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">glszm_features</span>
        <span class="k">if</span> <span class="n">gldzm_features</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">image</span><span class="p">[</span><span class="s1">&#39;texture&#39;</span><span class="p">][</span><span class="s1">&#39;gldzm_3D&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">processing_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">gldzm_features</span>
        <span class="k">if</span> <span class="n">ngtdm_features</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">image</span><span class="p">[</span><span class="s1">&#39;texture&#39;</span><span class="p">][</span><span class="s1">&#39;ngtdm_3D&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">processing_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ngtdm_features</span>
        <span class="k">if</span> <span class="n">ngldm_features</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">image</span><span class="p">[</span><span class="s1">&#39;texture&#39;</span><span class="p">][</span><span class="s1">&#39;ngldm_3D&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">processing_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ngldm_features</span></div>

<div class="viewcode-block" id="MEDimage.save_radiomics"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.save_radiomics">[docs]</a>    <span class="k">def</span> <span class="nf">save_radiomics</span><span class="p">(</span>
                    <span class="bp">self</span><span class="p">,</span> <span class="n">scan_file_name</span><span class="p">:</span> <span class="n">List</span><span class="p">,</span> 
                    <span class="n">path_save</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">roi_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
                    <span class="n">roi_type_label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">patient_num</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves extracted radiomics features in a JSON file.</span>

<span class="sd">        Args:</span>
<span class="sd">            scan_file_name(List): List of scan files.</span>
<span class="sd">            path_save(Path): Saving path.</span>
<span class="sd">            roi_type(str): Type of the ROI.</span>
<span class="sd">            roi_type_label(str): Label of the ROI type.</span>
<span class="sd">            patient_num(int): Index of scan.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">path_save</span> <span class="o">/</span> <span class="s2">&quot;features&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="p">(</span><span class="n">path_save</span> <span class="o">/</span> <span class="s2">&quot;features&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">()</span>
            <span class="n">path_save</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path_save</span> <span class="o">/</span> <span class="s2">&quot;features&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">path_save</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path_save</span><span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;roi_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">roi_type</span>
        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;patientID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">patientID</span>
        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;vox_dim&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">([</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">volume</span><span class="o">.</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">PixelExtentInWorldX</span><span class="p">,</span> 
                                <span class="bp">self</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">volume</span><span class="o">.</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">PixelExtentInWorldY</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">volume</span><span class="o">.</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">PixelExtentInWorldZ</span>
                                <span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">update_params</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">scan_file_name</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">index_dot</span> <span class="o">=</span> <span class="n">scan_file_name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="n">scan_file_name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.npy&#39;</span><span class="p">)</span>
            <span class="n">name_save</span> <span class="o">=</span> <span class="n">scan_file_name</span><span class="p">[:</span><span class="n">index_dot</span><span class="p">]</span> <span class="o">+</span> \
                        <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">roi_type_label</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span> <span class="o">+</span> \
                        <span class="n">scan_file_name</span><span class="p">[</span><span class="n">index_dot</span> <span class="p">:</span> <span class="n">ext</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">patient_num</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">index_dot</span> <span class="o">=</span> <span class="n">scan_file_name</span><span class="p">[</span><span class="n">patient_num</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="n">scan_file_name</span><span class="p">[</span><span class="n">patient_num</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;.npy&#39;</span><span class="p">)</span>
            <span class="n">name_save</span> <span class="o">=</span> <span class="n">scan_file_name</span><span class="p">[</span><span class="n">patient_num</span><span class="p">][:</span><span class="n">index_dot</span><span class="p">]</span> <span class="o">+</span> \
                        <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">roi_type_label</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span> <span class="o">+</span> \
                        <span class="n">scan_file_name</span><span class="p">[</span><span class="n">patient_num</span><span class="p">][</span><span class="n">index_dot</span> <span class="p">:</span> <span class="n">ext</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`patient_num` must be speicifed or `scan_file_name` msut be str&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_save</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name_save</span><span class="si">}</span><span class="s2">.json&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>   
            <span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radiomics</span><span class="o">.</span><span class="n">to_json</span><span class="p">(),</span> <span class="n">fp</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">NumpyEncoder</span><span class="p">)</span></div>


<div class="viewcode-block" id="MEDimage.Params"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params">[docs]</a>    <span class="k">class</span> <span class="nc">Params</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Organizes all processing, filtering and features extraction parameters&quot;&quot;&quot;</span>

<div class="viewcode-block" id="MEDimage.Params.__init__"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.__init__">[docs]</a>        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Organizes all processing, filtering and features extraction</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Process</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Filter</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radiomics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Radiomics</span><span class="p">()</span></div>


<div class="viewcode-block" id="MEDimage.Params.Process"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Process">[docs]</a>        <span class="k">class</span> <span class="nc">Process</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Organizes all processing parameters.&quot;&quot;&quot;</span>
<div class="viewcode-block" id="MEDimage.Params.Process.__init__"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Process.__init__">[docs]</a>            <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                Constructor of the `Process` class.</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">algo</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;algo&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;algo&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">box_string</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;box_string&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;box_string&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filter</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;filter&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;filter&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gl_round</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gl_round&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;gl_round&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gray_levels</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;gray_levels&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;gray_levels&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ih</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ih&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;ih&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">im_range</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;im_range&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;im_range&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">im_type</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;im_type&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;im_type&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">intensity</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;intensity&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;intensity&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ivh</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ivh&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;ivh&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">n_algo</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;n_algo&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;n_algo&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">n_exp</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;n_exp&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;n_exp&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">n_gl</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;n_gl&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;n_gl&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">n_scale</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;n_scale&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;n_scale&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">outliers</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;outliers&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;outliers&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scale_non_text</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scale_non_text&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;scale_non_text&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scale_text</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scale_text&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;scale_text&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roi_interp</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;roi_interp&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;roi_interp&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roi_pv</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;roi_pv&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;roi_pv&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">user_set_min_value</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;user_set_min_value&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;user_set_min_value&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vol_interp</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;vol_interp&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;vol_interp&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="MEDimage.Params.Process.init_from_json"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Process.init_from_json">[docs]</a>            <span class="k">def</span> <span class="nf">init_from_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path_to_json</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                Updates class attributes from json file.</span>

<span class="sd">                Args:</span>
<span class="sd">                    path_to_json(Union[Path, str]): Path to the JSON file with processing parameters.</span>
<span class="sd">                </span>
<span class="sd">                Returns:</span>
<span class="sd">                    None.</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="n">__params</span> <span class="o">=</span> <span class="n">load_json</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">path_to_json</span><span class="p">))</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">algo</span> <span class="o">=</span> <span class="n">__params</span><span class="p">[</span><span class="s1">&#39;algo&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;algo&#39;</span> <span class="ow">in</span> <span class="n">__params</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">algo</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">box_string</span> <span class="o">=</span> <span class="n">__params</span><span class="p">[</span><span class="s1">&#39;box_string&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;box_string&#39;</span> <span class="ow">in</span> <span class="n">__params</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">box_string</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filter</span> <span class="o">=</span> <span class="n">__params</span><span class="p">[</span><span class="s1">&#39;filter&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;filter&#39;</span> <span class="ow">in</span> <span class="n">__params</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gl_round</span> <span class="o">=</span> <span class="n">__params</span><span class="p">[</span><span class="s1">&#39;gl_round&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;gl_round&#39;</span> <span class="ow">in</span> <span class="n">__params</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">gl_round</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gray_levels</span> <span class="o">=</span> <span class="n">__params</span><span class="p">[</span><span class="s1">&#39;gray_levels&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;gray_levels&#39;</span> <span class="ow">in</span> <span class="n">__params</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">gray_levels</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ih</span> <span class="o">=</span> <span class="n">__params</span><span class="p">[</span><span class="s1">&#39;ih&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;ih&#39;</span> <span class="ow">in</span> <span class="n">__params</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">ih</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">im_range</span> <span class="o">=</span> <span class="n">__params</span><span class="p">[</span><span class="s1">&#39;im_range&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;im_range&#39;</span> <span class="ow">in</span> <span class="n">__params</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">im_range</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">im_type</span> <span class="o">=</span> <span class="n">__params</span><span class="p">[</span><span class="s1">&#39;im_type&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;im_type&#39;</span> <span class="ow">in</span> <span class="n">__params</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">im_type</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">intensity</span> <span class="o">=</span> <span class="n">__params</span><span class="p">[</span><span class="s1">&#39;intensity&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;intensity&#39;</span> <span class="ow">in</span> <span class="n">__params</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">intensity</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ivh</span> <span class="o">=</span> <span class="n">__params</span><span class="p">[</span><span class="s1">&#39;ivh&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;ivh&#39;</span> <span class="ow">in</span> <span class="n">__params</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">ivh</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">n_algo</span> <span class="o">=</span> <span class="n">__params</span><span class="p">[</span><span class="s1">&#39;n_algo&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;n_algo&#39;</span> <span class="ow">in</span> <span class="n">__params</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_algo</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">n_exp</span> <span class="o">=</span> <span class="n">__params</span><span class="p">[</span><span class="s1">&#39;n_exp&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;n_exp&#39;</span> <span class="ow">in</span> <span class="n">__params</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_exp</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">n_gl</span> <span class="o">=</span> <span class="n">__params</span><span class="p">[</span><span class="s1">&#39;n_gl&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;n_gl&#39;</span> <span class="ow">in</span> <span class="n">__params</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_gl</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">n_scale</span> <span class="o">=</span> <span class="n">__params</span><span class="p">[</span><span class="s1">&#39;n_scale&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;n_scale&#39;</span> <span class="ow">in</span> <span class="n">__params</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_scale</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">outliers</span> <span class="o">=</span> <span class="n">__params</span><span class="p">[</span><span class="s1">&#39;outliers&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;outliers&#39;</span> <span class="ow">in</span> <span class="n">__params</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">outliers</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scale_non_text</span> <span class="o">=</span> <span class="n">__params</span><span class="p">[</span><span class="s1">&#39;scale_non_text&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;scale_non_text&#39;</span> <span class="ow">in</span> <span class="n">__params</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_non_text</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scale_text</span> <span class="o">=</span> <span class="n">__params</span><span class="p">[</span><span class="s1">&#39;scale_text&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;scale_text&#39;</span> <span class="ow">in</span> <span class="n">__params</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_text</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roi_interp</span> <span class="o">=</span> <span class="n">__params</span><span class="p">[</span><span class="s1">&#39;roi_interp&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;roi_interp&#39;</span> <span class="ow">in</span> <span class="n">__params</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">roi_interp</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roi_pv</span> <span class="o">=</span> <span class="n">__params</span><span class="p">[</span><span class="s1">&#39;roi_pv&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;roi_pv&#39;</span> <span class="ow">in</span> <span class="n">__params</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">roi_pv</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">user_set_min_value</span> <span class="o">=</span> <span class="n">__params</span><span class="p">[</span><span class="s1">&#39;user_set_min_value&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;user_set_min_value&#39;</span> <span class="ow">in</span> <span class="n">__params</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_set_min_value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vol_interp</span> <span class="o">=</span> <span class="n">__params</span><span class="p">[</span><span class="s1">&#39;vol_interp&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;vol_interp&#39;</span> <span class="ow">in</span> <span class="n">__params</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">vol_interp</span></div></div>


<div class="viewcode-block" id="MEDimage.Params.Filter"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Filter">[docs]</a>        <span class="k">class</span> <span class="nc">Filter</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Organizes all filtering parameters&quot;&quot;&quot;</span>
<div class="viewcode-block" id="MEDimage.Params.Filter.__init__"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Filter.__init__">[docs]</a>            <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                Constructor of the Filter class.</span>

<span class="sd">                Args:</span>
<span class="sd">                    filter_type(str): Type of the filter that will be used (Must be &#39;mean&#39;, &#39;log&#39;, &#39;laws&#39;,</span>
<span class="sd">                        &#39;gabor&#39; or &#39;wavelet&#39;).</span>
<span class="sd">                </span>
<span class="sd">                Returns:</span>
<span class="sd">                    None.</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filter_type</span> <span class="o">=</span> <span class="n">filter_type</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Mean</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Log</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gabor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Gabor</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">laws</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Laws</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Wavelet</span><span class="p">()</span></div>


<div class="viewcode-block" id="MEDimage.Params.Filter.Mean"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Filter.Mean">[docs]</a>            <span class="k">class</span> <span class="nc">Mean</span><span class="p">:</span>
                <span class="sd">&quot;&quot;&quot;Organizes the Mean filter parameters&quot;&quot;&quot;</span>
<div class="viewcode-block" id="MEDimage.Params.Filter.Mean.__init__"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Filter.Mean.__init__">[docs]</a>                <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
                        <span class="bp">self</span><span class="p">,</span> <span class="n">ndims</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">name_save</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> 
                        <span class="n">padding</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                    Constructor of the Mean class.</span>

<span class="sd">                    Args:</span>
<span class="sd">                        ndims(int): Filter dimension. </span>
<span class="sd">                        name_save(str): Specific name added to final extraction results file. </span>
<span class="sd">                        padding(str): padding mode. </span>
<span class="sd">                        size(int): Filter size. </span>
<span class="sd">                                       </span>
<span class="sd">                    Returns:</span>
<span class="sd">                        None.</span>
<span class="sd">                    &quot;&quot;&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name_save</span> <span class="o">=</span> <span class="n">name_save</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ndims</span> <span class="o">=</span> <span class="n">ndims</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span></div>

<div class="viewcode-block" id="MEDimage.Params.Filter.Mean.init_from_json"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Filter.Mean.init_from_json">[docs]</a>                <span class="k">def</span> <span class="nf">init_from_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                    Updates class attributes from json file.</span>

<span class="sd">                    Args:</span>
<span class="sd">                        params(Dict): Dictionary of the Mean filter parameters.</span>
<span class="sd">                    </span>
<span class="sd">                    Returns:</span>
<span class="sd">                        None.</span>
<span class="sd">                    &quot;&quot;&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name_save</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;name_save&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ndims</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;ndims&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;padding&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;size&#39;</span><span class="p">]</span></div></div>


<div class="viewcode-block" id="MEDimage.Params.Filter.Log"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Filter.Log">[docs]</a>            <span class="k">class</span> <span class="nc">Log</span><span class="p">:</span>
                <span class="sd">&quot;&quot;&quot;Organizes the Log filter parameters&quot;&quot;&quot;</span>
<div class="viewcode-block" id="MEDimage.Params.Filter.Log.__init__"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Filter.Log.__init__">[docs]</a>                <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
                        <span class="bp">self</span><span class="p">,</span> <span class="n">ndims</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> 
                        <span class="n">padding</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">orthogonal_rot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
                        <span class="n">name_save</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                    Constructor of the Log class.</span>

<span class="sd">                    Args:</span>
<span class="sd">                        ndims(int): Filter dimension. </span>
<span class="sd">                        sigma(float): Float of the sigma value.</span>
<span class="sd">                        padding(str): padding mode.</span>
<span class="sd">                        orthogonal_rot(bool): If True will compute average response over orthogonal planes. </span>
<span class="sd">                        name_save(str): Specific name added to final extraction results file. </span>
<span class="sd">                                       </span>
<span class="sd">                    Returns:</span>
<span class="sd">                        None.</span>
<span class="sd">                    &quot;&quot;&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name_save</span> <span class="o">=</span> <span class="n">name_save</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ndims</span> <span class="o">=</span> <span class="n">ndims</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">orthogonal_rot</span> <span class="o">=</span> <span class="n">orthogonal_rot</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma</span></div>

<div class="viewcode-block" id="MEDimage.Params.Filter.Log.init_from_json"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Filter.Log.init_from_json">[docs]</a>                <span class="k">def</span> <span class="nf">init_from_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                    Updates class attributes from json file.</span>

<span class="sd">                    Args:</span>
<span class="sd">                        params(Dict): Dictionary of the Log filter parameters.</span>
<span class="sd">                    </span>
<span class="sd">                    Returns:</span>
<span class="sd">                        None.</span>
<span class="sd">                    &quot;&quot;&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name_save</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;name_save&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ndims</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;ndims&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">orthogonal_rot</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;orthogonal_rot&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;padding&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span></div></div>


<div class="viewcode-block" id="MEDimage.Params.Filter.Gabor"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Filter.Gabor">[docs]</a>            <span class="k">class</span> <span class="nc">Gabor</span><span class="p">:</span>
                <span class="sd">&quot;&quot;&quot;Organizes the gabor filter parameters&quot;&quot;&quot;</span>
<div class="viewcode-block" id="MEDimage.Params.Filter.Gabor.__init__"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Filter.Gabor.__init__">[docs]</a>                <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
                        <span class="bp">self</span><span class="p">,</span> <span class="n">sigma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">_lambda</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>  
                        <span class="n">gamma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">theta</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">rot_invariance</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                        <span class="n">orthogonal_rot</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">name_save</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                        <span class="n">padding</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                    Constructor of the Gabor class.</span>

<span class="sd">                    Args:</span>
<span class="sd">                        sigma(float): Float of the sigma value.</span>
<span class="sd">                        _lambda(float): Float of the lambda value.</span>
<span class="sd">                        gamma(float): Float of the gamma value.</span>
<span class="sd">                        theta(str): String of the theta angle value.</span>
<span class="sd">                        rot_invariance(bool): If True the filter will be rotation invariant.</span>
<span class="sd">                        orthogonal_rot(bool): If True will compute average response over orthogonal planes.</span>
<span class="sd">                        name_save(str): Specific name added to final extraction results file.</span>
<span class="sd">                        padding(str): padding mode.</span>
<span class="sd">                                       </span>
<span class="sd">                    Returns:</span>
<span class="sd">                        None.</span>
<span class="sd">                    &quot;&quot;&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_lambda</span> <span class="o">=</span> <span class="n">_lambda</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">gamma</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name_save</span> <span class="o">=</span> <span class="n">name_save</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">orthogonal_rot</span> <span class="o">=</span> <span class="n">orthogonal_rot</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rot_invariance</span> <span class="o">=</span> <span class="n">rot_invariance</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span></div>

<div class="viewcode-block" id="MEDimage.Params.Filter.Gabor.init_from_json"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Filter.Gabor.init_from_json">[docs]</a>                <span class="k">def</span> <span class="nf">init_from_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                    Updates class attributes from json file.</span>

<span class="sd">                    Args:</span>
<span class="sd">                        params(Dict): Dictionary of the gabor filter parameters.</span>
<span class="sd">                    </span>
<span class="sd">                    Returns:</span>
<span class="sd">                        None.</span>
<span class="sd">                    &quot;&quot;&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_lambda</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;_lambda&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">gamma</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;gamma&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name_save</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;name_save&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">orthogonal_rot</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;orthogonal_rot&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;padding&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rot_invariance</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;rot_invariance&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;pi/&#39;</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="nb">int</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">elif</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;-pi/&#39;</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="nb">int</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">])</span></div></div>


<div class="viewcode-block" id="MEDimage.Params.Filter.Laws"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Filter.Laws">[docs]</a>            <span class="k">class</span> <span class="nc">Laws</span><span class="p">:</span>
                <span class="sd">&quot;&quot;&quot;Organizes the laws filter parameters&quot;&quot;&quot;</span>
<div class="viewcode-block" id="MEDimage.Params.Filter.Laws.__init__"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Filter.Laws.__init__">[docs]</a>                <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
                        <span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">energy_distance</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 
                        <span class="n">energy_image</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">rot_invariance</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
                        <span class="n">orthogonal_rot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">name_save</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">padding</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                    Constructor of the Laws class.</span>

<span class="sd">                    Args:</span>
<span class="sd">                        config(List): Configuration of the Laws filter, for ex: [&#39;E5&#39;, &#39;L5&#39;, &#39;E5&#39;].</span>
<span class="sd">                        energy_distance(int): Chebyshev distance.</span>
<span class="sd">                        energy_image(bool): If True will compute the Laws terxture energy image.</span>
<span class="sd">                        rot_invariance(bool): If True the filter will be rotation invariant.</span>
<span class="sd">                        orthogonal_rot(bool): If True will compute average response over orthogonal planes.</span>
<span class="sd">                        name_save(str): Specific name added to final extraction results file.</span>
<span class="sd">                        padding(str): padding mode.</span>
<span class="sd">                                       </span>
<span class="sd">                    Returns:</span>
<span class="sd">                        None.</span>
<span class="sd">                    &quot;&quot;&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">energy_distance</span> <span class="o">=</span> <span class="n">energy_distance</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">energy_image</span> <span class="o">=</span> <span class="n">energy_image</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name_save</span> <span class="o">=</span> <span class="n">name_save</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">orthogonal_rot</span> <span class="o">=</span> <span class="n">orthogonal_rot</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rot_invariance</span> <span class="o">=</span> <span class="n">rot_invariance</span></div>

<div class="viewcode-block" id="MEDimage.Params.Filter.Laws.init_from_json"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Filter.Laws.init_from_json">[docs]</a>                <span class="k">def</span> <span class="nf">init_from_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                    Updates class attributes from json file.</span>

<span class="sd">                    Args:</span>
<span class="sd">                        params(Dict): Dictionary of the laws filter parameters.</span>
<span class="sd">                    </span>
<span class="sd">                    Returns:</span>
<span class="sd">                        None.</span>
<span class="sd">                    &quot;&quot;&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;config&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">energy_distance</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;energy_distance&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">energy_image</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;energy_image&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name_save</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;name_save&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">orthogonal_rot</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;orthogonal_rot&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;padding&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rot_invariance</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;rot_invariance&#39;</span><span class="p">]</span></div></div>


<div class="viewcode-block" id="MEDimage.Params.Filter.Wavelet"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Filter.Wavelet">[docs]</a>            <span class="k">class</span> <span class="nc">Wavelet</span><span class="p">:</span>
                <span class="sd">&quot;&quot;&quot;Organizes the Wavelet filter parameters&quot;&quot;&quot;</span>
<div class="viewcode-block" id="MEDimage.Params.Filter.Wavelet.__init__"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Filter.Wavelet.__init__">[docs]</a>                <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
                        <span class="bp">self</span><span class="p">,</span> <span class="n">ndims</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">name_save</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> 
                        <span class="n">basis_function</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">subband</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> 
                        <span class="n">rot_invariance</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">padding</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                    Constructor of the Wavelet class.</span>

<span class="sd">                    Args:</span>
<span class="sd">                        ndims(int): Dimension of the filter.</span>
<span class="sd">                        name_save(str): Specific name added to final extraction results file.</span>
<span class="sd">                        basis_function(str): Wavelet basis function.</span>
<span class="sd">                        subband(str): Wavelet subband.</span>
<span class="sd">                        level(int): Decomposition level.</span>
<span class="sd">                        rot_invariance(bool): If True the filter will be rotation invariant.</span>
<span class="sd">                        padding(str): padding mode.</span>
<span class="sd">                                       </span>
<span class="sd">                    Returns:</span>
<span class="sd">                        None.</span>
<span class="sd">                    &quot;&quot;&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">basis_function</span> <span class="o">=</span> <span class="n">basis_function</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="n">level</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ndims</span> <span class="o">=</span> <span class="n">ndims</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name_save</span> <span class="o">=</span> <span class="n">name_save</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">padding</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rot_invariance</span> <span class="o">=</span> <span class="n">rot_invariance</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">subband</span> <span class="o">=</span> <span class="n">subband</span></div>

<div class="viewcode-block" id="MEDimage.Params.Filter.Wavelet.init_from_json"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Filter.Wavelet.init_from_json">[docs]</a>                <span class="k">def</span> <span class="nf">init_from_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                    Updates class attributes from json file.</span>

<span class="sd">                    Args:</span>
<span class="sd">                        params(Dict): Dictionary of the wavelet filter parameters.</span>
<span class="sd">                    </span>
<span class="sd">                    Returns:</span>
<span class="sd">                        None.</span>
<span class="sd">                    &quot;&quot;&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">basis_function</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;basis_function&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;level&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ndims</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;ndims&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name_save</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;name_save&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">padding</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;padding&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rot_invariance</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;rot_invariance&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">subband</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;subband&#39;</span><span class="p">]</span></div></div></div>


<div class="viewcode-block" id="MEDimage.Params.Radiomics"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Radiomics">[docs]</a>        <span class="k">class</span> <span class="nc">Radiomics</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Organizes the radiomics extraction parameters&quot;&quot;&quot;</span>
<div class="viewcode-block" id="MEDimage.Params.Radiomics.__init__"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Radiomics.__init__">[docs]</a>            <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                Constructor of the Radiomics class.</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ih_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ih_name&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;ih_name&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ivh_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ivh_name&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;ivh_name&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">glcm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GLCM</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">glrlm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GLRLM</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gldzm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GLDZM</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ngtdm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NGTDM</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ngldm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">NGLDM</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name_text_types</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;name_text_types&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;name_text_types&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">processing_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;processing_name&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;processing_name&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scale_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;scale_name&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;scale_name&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="MEDimage.Params.Radiomics.GLCM"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Radiomics.GLCM">[docs]</a>            <span class="k">class</span> <span class="nc">GLCM</span><span class="p">:</span>
                <span class="sd">&quot;&quot;&quot;Organizes the GLCM features extraction parameters&quot;&quot;&quot;</span>
<div class="viewcode-block" id="MEDimage.Params.Radiomics.GLCM.__init__"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Radiomics.GLCM.__init__">[docs]</a>                <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
                        <span class="bp">self</span><span class="p">,</span> 
                        <span class="n">symmetry</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="n">distance_norm</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="n">dist_correction</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                        <span class="n">merge_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;vol_merge&quot;</span>
                <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                    Constructor of the GLCM class</span>

<span class="sd">                    Args:</span>
<span class="sd">                        symmetry(str): Symmetry type.</span>
<span class="sd">                        distance_norm(Dict): Dictionary of extra parameters to add.</span>
<span class="sd">                        dist_correction(Union[bool, str]): norm for distance weighting, must be </span>
<span class="sd">                            &quot;manhattan&quot;, &quot;euclidean&quot; or &quot;chebyshev&quot;. If True the norm for distance weighting </span>
<span class="sd">                            is gonna be &quot;euclidean&quot;.</span>
<span class="sd">                        merge_method(str): merging method which determines how features are</span>
<span class="sd">                            calculated. Must be &quot;average&quot;, &quot;slice_merge&quot;, &quot;dir_merge&quot; and &quot;vol_merge&quot;.</span>
<span class="sd">                                       </span>
<span class="sd">                    Returns:</span>
<span class="sd">                        None.</span>
<span class="sd">                    &quot;&quot;&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">symmetry</span> <span class="o">=</span> <span class="n">symmetry</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">distance_norm</span> <span class="o">=</span> <span class="n">distance_norm</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dist_correction</span> <span class="o">=</span> <span class="n">dist_correction</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">merge_method</span> <span class="o">=</span> <span class="n">merge_method</span></div></div>


<div class="viewcode-block" id="MEDimage.Params.Radiomics.GLRLM"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Radiomics.GLRLM">[docs]</a>            <span class="k">class</span> <span class="nc">GLRLM</span><span class="p">:</span>
                <span class="sd">&quot;&quot;&quot;Organizes the GLRLM features extraction parameters&quot;&quot;&quot;</span>
<div class="viewcode-block" id="MEDimage.Params.Radiomics.GLRLM.__init__"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Radiomics.GLRLM.__init__">[docs]</a>                <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
                        <span class="bp">self</span><span class="p">,</span> 
                        <span class="n">dist_correction</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                        <span class="n">merge_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;vol_merge&quot;</span>
                <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                    Constructor of the GLRLM class</span>

<span class="sd">                    Args:</span>
<span class="sd">                        dist_correction(bool): If True the norm for distance weighting is gonna be &quot;euclidean&quot;.</span>
<span class="sd">                        merge_method(str): merging method which determines how features are</span>
<span class="sd">                            calculated. Must be &quot;average&quot;, &quot;slice_merge&quot;, &quot;dir_merge&quot; and &quot;vol_merge&quot;.</span>

<span class="sd">                    Returns:</span>
<span class="sd">                        None.</span>
<span class="sd">                    &quot;&quot;&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dist_correction</span> <span class="o">=</span> <span class="n">dist_correction</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">merge_method</span> <span class="o">=</span> <span class="n">merge_method</span></div></div>


<div class="viewcode-block" id="MEDimage.Params.Radiomics.GLDZM"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Radiomics.GLDZM">[docs]</a>            <span class="k">class</span> <span class="nc">GLDZM</span><span class="p">:</span>
                <span class="sd">&quot;&quot;&quot;Organizes the GLDZM features extraction parameters&quot;&quot;&quot;</span>
<div class="viewcode-block" id="MEDimage.Params.Radiomics.GLDZM.__init__"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Radiomics.GLDZM.__init__">[docs]</a>                <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
                        <span class="bp">self</span><span class="p">,</span> 
                        <span class="n">distance_norm</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                    Constructor of the GLDZM class</span>

<span class="sd">                    Args:</span>
<span class="sd">                        distance_norm(Dict): Dictionary of extra parameters to add.</span>

<span class="sd">                    Returns:</span>
<span class="sd">                        None.</span>
<span class="sd">                    &quot;&quot;&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">distance_norm</span> <span class="o">=</span> <span class="n">distance_norm</span></div></div>


<div class="viewcode-block" id="MEDimage.Params.Radiomics.NGTDM"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Radiomics.NGTDM">[docs]</a>            <span class="k">class</span> <span class="nc">NGTDM</span><span class="p">:</span>
                <span class="sd">&quot;&quot;&quot;Organizes the NGTDM features extraction parameters&quot;&quot;&quot;</span>
<div class="viewcode-block" id="MEDimage.Params.Radiomics.NGTDM.__init__"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Radiomics.NGTDM.__init__">[docs]</a>                <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
                        <span class="bp">self</span><span class="p">,</span> 
                        <span class="n">distance_norm</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="n">dist_correction</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                    Constructor of the NGTDM class</span>

<span class="sd">                    Args:</span>
<span class="sd">                        distance_norm(Dict): Dictionary of extra parameters to add.</span>
<span class="sd">                        dist_correction(bool): If True the norm for distance weighting is gonna be &quot;euclidean&quot;.</span>

<span class="sd">                    Returns:</span>
<span class="sd">                        None.</span>
<span class="sd">                    &quot;&quot;&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">distance_norm</span> <span class="o">=</span> <span class="n">distance_norm</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dist_correction</span> <span class="o">=</span> <span class="n">dist_correction</span></div></div>


<div class="viewcode-block" id="MEDimage.Params.Radiomics.NGLDM"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Radiomics.NGLDM">[docs]</a>            <span class="k">class</span> <span class="nc">NGLDM</span><span class="p">:</span>
                <span class="sd">&quot;&quot;&quot;Organizes the NGLDM features extraction parameters&quot;&quot;&quot;</span>
<div class="viewcode-block" id="MEDimage.Params.Radiomics.NGLDM.__init__"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Params.Radiomics.NGLDM.__init__">[docs]</a>                <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distance_norm</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                    Constructor of the NGLDM class</span>

<span class="sd">                    Args:</span>
<span class="sd">                        distance_norm(Dict): Dictionary of extra parameters to add.</span>

<span class="sd">                    Returns:</span>
<span class="sd">                        None.</span>
<span class="sd">                    &quot;&quot;&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">distance_norm</span> <span class="o">=</span> <span class="n">distance_norm</span></div></div></div></div>


<div class="viewcode-block" id="MEDimage.Radiomics"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Radiomics">[docs]</a>    <span class="k">class</span> <span class="nc">Radiomics</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Organizes all the extracted features.</span>
<span class="sd">        &quot;&quot;&quot;</span>
<div class="viewcode-block" id="MEDimage.Radiomics.__init__"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Radiomics.__init__">[docs]</a>        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">image</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Constructor of the Radiomics class</span>
<span class="sd">            Args:</span>
<span class="sd">                image(Dict): Dict of the extracted features.</span>
<span class="sd">                params(Dict): Dict of the parameters used in features extraction (roi type, voxels diemension...)</span>
<span class="sd">            </span>
<span class="sd">            Returns:</span>
<span class="sd">                None</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">image</span> <span class="k">if</span> <span class="n">image</span> <span class="k">else</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="k">if</span> <span class="n">params</span> <span class="k">else</span> <span class="p">{}</span></div>

<div class="viewcode-block" id="MEDimage.Radiomics.update_params"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Radiomics.update_params">[docs]</a>        <span class="k">def</span> <span class="nf">update_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Updates `params` attribute from a given Dict</span>
<span class="sd">                Args:</span>
<span class="sd">                    params(Dict): Dict of the parameters used in features extraction (roi type, voxels diemension...)</span>
<span class="sd">                </span>
<span class="sd">                Returns:</span>
<span class="sd">                    None</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;roi_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;roi_type&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;patientID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;patientID&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;vox_dim&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;vox_dim&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="MEDimage.Radiomics.to_json"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.Radiomics.to_json">[docs]</a>        <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Summarizes the class attributes in a Dict</span>
<span class="sd">                Args:</span>
<span class="sd">                    None</span>
<span class="sd">                </span>
<span class="sd">                Returns:</span>
<span class="sd">                    Dict: Dictionay of radiomics structure (extracted features and extraction params)</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">radiomics</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;image&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="p">,</span>
                <span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span>
            <span class="p">}</span>
            <span class="k">return</span> <span class="n">radiomics</span></div></div>


<div class="viewcode-block" id="MEDimage.scan"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan">[docs]</a>    <span class="k">class</span> <span class="nc">scan</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Organizes all imaging data (volume and ROI). </span>

<span class="sd">        Attributes:</span>
<span class="sd">            volume (object): Instance of MEDimage.scan.volume inner class.</span>
<span class="sd">            ROI (object): Instance of MEDimage.scan.ROI inner class.</span>
<span class="sd">            orientation (str): Imaging data orientation (axial, sagittal or coronal).</span>
<span class="sd">            patientPosition (str): Patient position specifies the position of the </span>
<span class="sd">                patient relative to the imaging equipment space (HFS, HFP...).</span>

<span class="sd">        &quot;&quot;&quot;</span>
<div class="viewcode-block" id="MEDimage.scan.__init__"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.__init__">[docs]</a>        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orientation</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">patientPosition</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Constructor of the scan class</span>

<span class="sd">            Args:</span>
<span class="sd">                orientation (str, optional): Imaging data orientation (axial, sagittal or coronal).</span>
<span class="sd">                patientPosition (str, optional): Patient position specifies the position of the </span>
<span class="sd">                    patient relative to the imaging equipment space (HFS, HFP...).</span>
<span class="sd">            </span>
<span class="sd">            Returns:</span>
<span class="sd">                None.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">()</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">volume_process</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume_process</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ROI</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ROI</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">orientation</span> <span class="o">=</span> <span class="n">orientation</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">patientPosition</span> <span class="o">=</span> <span class="n">patientPosition</span></div>

<div class="viewcode-block" id="MEDimage.scan.set_patientPosition"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.set_patientPosition">[docs]</a>        <span class="k">def</span> <span class="nf">set_patientPosition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patientPosition</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">patientPosition</span> <span class="o">=</span> <span class="n">patientPosition</span></div>

<div class="viewcode-block" id="MEDimage.scan.set_orientation"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.set_orientation">[docs]</a>        <span class="k">def</span> <span class="nf">set_orientation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orientation</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">orientation</span> <span class="o">=</span> <span class="n">orientation</span></div>
        
<div class="viewcode-block" id="MEDimage.scan.set_volume"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.set_volume">[docs]</a>        <span class="k">def</span> <span class="nf">set_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">volume</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="n">volume</span></div>
        
<div class="viewcode-block" id="MEDimage.scan.set_ROI"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.set_ROI">[docs]</a>        <span class="k">def</span> <span class="nf">set_ROI</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ROI</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ROI</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="MEDimage.scan.get_roi_from_indexes"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.get_roi_from_indexes">[docs]</a>        <span class="k">def</span> <span class="nf">get_roi_from_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Extracts ROI data using the saved indexes (Indexes of non-null values).</span>

<span class="sd">            Args:</span>
<span class="sd">                key (int): Key of ROI indexes list (A volume can have multiple ROIs).</span>

<span class="sd">            Returns:</span>
<span class="sd">                ndarray: n-dimensional array of ROI data.</span>
<span class="sd">            </span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">roi_volume</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="n">roi_volume</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ROI</span><span class="o">.</span><span class="n">get_indexes</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">roi_volume</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span></div>

<div class="viewcode-block" id="MEDimage.scan.get_indexes_by_roi_name"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.get_indexes_by_roi_name">[docs]</a>        <span class="k">def</span> <span class="nf">get_indexes_by_roi_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">roi_name</span> <span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Extract ROI data using the ROI name.</span>

<span class="sd">            Args:</span>
<span class="sd">                roi_name (str): String of the ROI name (A volume can have multiple ROIs).</span>

<span class="sd">            Returns:</span>
<span class="sd">                ndarray: n-dimensional array of the ROI data.</span>
<span class="sd">            </span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">roi_name_key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ROI</span><span class="o">.</span><span class="n">roi_names</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">roi_name</span><span class="p">)</span>
            <span class="n">roi_volume</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
            <span class="n">roi_volume</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ROI</span><span class="o">.</span><span class="n">get_indexes</span><span class="p">(</span><span class="n">roi_name_key</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">roi_volume</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span></div>

<div class="viewcode-block" id="MEDimage.scan.display"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.display">[docs]</a>        <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_slice</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Displays slices from imaging data with the ROI contour in XY-Plane.</span>

<span class="sd">            Args:</span>
<span class="sd">                _slice (int, optional): Index of the slice you want to plot.</span>

<span class="sd">            Returns:</span>
<span class="sd">                None.</span>
<span class="sd">            </span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># extract slices containing ROI</span>
            <span class="n">size_m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">size_m</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">size_m</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">size_m</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">ind_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_roi_from_indexes</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
            <span class="n">J</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">)</span>
            <span class="n">I</span> <span class="o">=</span> <span class="n">I</span><span class="p">[</span><span class="n">ind_mask</span><span class="p">]</span>
            <span class="n">J</span> <span class="o">=</span> <span class="n">J</span><span class="p">[</span><span class="n">ind_mask</span><span class="p">]</span>
            <span class="n">K</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="n">ind_mask</span><span class="p">]</span>
            <span class="n">slices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>

            <span class="n">vol_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[:,</span> <span class="p">:,</span> <span class="n">slices</span><span class="p">]</span>
            <span class="n">roi_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_roi_from_indexes</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[:,</span> <span class="p">:,</span> <span class="n">slices</span><span class="p">]</span>        
            
            <span class="n">rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">slices</span><span class="p">))))</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">slices</span><span class="p">)</span> <span class="o">/</span> <span class="n">rows</span><span class="p">))</span>
            
            <span class="n">plt</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">())</span>
            
            <span class="c1"># plot only one slice</span>
            <span class="k">if</span> <span class="n">_slice</span><span class="p">:</span>
                <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span>  <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">_slice</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vol_data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">_slice</span><span class="p">])</span>
                <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">((</span><span class="n">roi_data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">_slice</span><span class="p">]))</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.45</span><span class="p">)</span>
                <span class="n">lps_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            
            <span class="c1"># plot multiple slices containing an ROI.</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span>  <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
                <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">rows</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">columns</span><span class="p">):</span>
                        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">s</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">slices</span><span class="p">):</span>
                            <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
                            <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vol_data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">s</span><span class="p">])</span>
                            <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">((</span><span class="n">roi_data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">s</span><span class="p">]))</span>
                            <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.45</span><span class="p">)</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">columns</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
                <span class="n">lps_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">columns</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">axs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;XY-Plane&#39;</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
            
            <span class="c1"># add the coordinates system</span>
            <span class="n">lps_ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
            <span class="n">lps_ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Coordinates system&quot;</span><span class="p">)</span>
            
            <span class="n">lps_ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
            <span class="n">lps_ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.5</span><span class="p">],</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
            <span class="n">lps_ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">],</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
            <span class="n">lps_ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;L&quot;</span><span class="p">)</span>
            <span class="n">lps_ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;P&quot;</span><span class="p">)</span>
            <span class="n">lps_ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s2">&quot;S&quot;</span><span class="p">)</span>

            <span class="n">lps_ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
            <span class="n">lps_ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="MEDimage.scan.display_process"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.display_process">[docs]</a>        <span class="k">def</span> <span class="nf">display_process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_slice</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Displays slices from imaging data with the ROI contour in XY-Plane.</span>

<span class="sd">            Args:</span>
<span class="sd">                _slice (int, optional): Index of the slice you want to plot.</span>

<span class="sd">            Returns:</span>
<span class="sd">                None.</span>
<span class="sd">            </span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># extract slices containing ROI</span>
            <span class="n">size_m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume_process</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">size_m</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">size_m</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">size_m</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">ind_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_roi_from_indexes</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
            <span class="n">J</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">)</span>
            <span class="n">I</span> <span class="o">=</span> <span class="n">I</span><span class="p">[</span><span class="n">ind_mask</span><span class="p">]</span>
            <span class="n">J</span> <span class="o">=</span> <span class="n">J</span><span class="p">[</span><span class="n">ind_mask</span><span class="p">]</span>
            <span class="n">K</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="n">ind_mask</span><span class="p">]</span>
            <span class="n">slices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>

            <span class="n">vol_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume_process</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[:,</span> <span class="p">:,</span> <span class="n">slices</span><span class="p">]</span>
            <span class="n">roi_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_roi_from_indexes</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[:,</span> <span class="p">:,</span> <span class="n">slices</span><span class="p">]</span>        
            
            <span class="n">rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">slices</span><span class="p">))))</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">slices</span><span class="p">)</span> <span class="o">/</span> <span class="n">rows</span><span class="p">))</span>
            
            <span class="n">plt</span><span class="o">.</span><span class="n">set_cmap</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">())</span>
            
            <span class="c1"># plot only one slice</span>
            <span class="k">if</span> <span class="n">_slice</span><span class="p">:</span>
                <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span>  <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">_slice</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vol_data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">_slice</span><span class="p">])</span>
                <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">((</span><span class="n">roi_data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">_slice</span><span class="p">]))</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.45</span><span class="p">)</span>
                <span class="n">lps_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            
            <span class="c1"># plot multiple slices containing an ROI.</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span>  <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
                <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">rows</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">columns</span><span class="p">):</span>
                        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">s</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">slices</span><span class="p">):</span>
                            <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
                            <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vol_data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">s</span><span class="p">])</span>
                            <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">((</span><span class="n">roi_data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">s</span><span class="p">]))</span>
                            <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.45</span><span class="p">)</span>
                        <span class="n">s</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">columns</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
                <span class="n">lps_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">columns</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">axs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;XY-Plane&#39;</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
            
            <span class="c1"># add the coordinates system</span>
            <span class="n">lps_ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
            <span class="n">lps_ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Coordinates system&quot;</span><span class="p">)</span>
            
            <span class="n">lps_ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
            <span class="n">lps_ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.5</span><span class="p">],</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
            <span class="n">lps_ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">],</span> <span class="n">scale_units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
            <span class="n">lps_ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;L&quot;</span><span class="p">)</span>
            <span class="n">lps_ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;P&quot;</span><span class="p">)</span>
            <span class="n">lps_ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s2">&quot;S&quot;</span><span class="p">)</span>

            <span class="n">lps_ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
            <span class="n">lps_ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="MEDimage.scan.volume"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.volume">[docs]</a>        <span class="k">class</span> <span class="nc">volume</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Organizes all volume data and information related to imaging volume. </span>

<span class="sd">            Attributes:</span>
<span class="sd">                spatialRef (imref3d): Imaging data orientation (axial, sagittal or coronal).</span>
<span class="sd">                scan_rot (ndarray): Array of the rotation applied to the XYZ points of the ROI.</span>
<span class="sd">                data (ndarray): n-dimensional of the imaging data.</span>

<span class="sd">            &quot;&quot;&quot;</span>
<div class="viewcode-block" id="MEDimage.scan.volume.__init__"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.volume.__init__">[docs]</a>            <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spatialRef</span><span class="p">:</span> <span class="n">imref3d</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scan_rot</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                <span class="sd">&quot;&quot;&quot;Organizes all volume data and information. </span>

<span class="sd">                Args:</span>
<span class="sd">                    spatialRef (imref3d, optional): Imaging data orientation (axial, sagittal or coronal).</span>
<span class="sd">                    scan_rot (ndarray, optional): Array of the rotation applied to the XYZ points of the ROI.</span>
<span class="sd">                    data (ndarray, optional): n-dimensional of the imaging data.</span>

<span class="sd">                &quot;&quot;&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spatialRef</span> <span class="o">=</span> <span class="n">spatialRef</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scan_rot</span> <span class="o">=</span> <span class="n">scan_rot</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span></div>

<div class="viewcode-block" id="MEDimage.scan.volume.update_spatialRef"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.volume.update_spatialRef">[docs]</a>            <span class="k">def</span> <span class="nf">update_spatialRef</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spatialRef_value</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spatialRef</span> <span class="o">=</span> <span class="n">spatialRef_value</span></div>
            
<div class="viewcode-block" id="MEDimage.scan.volume.update_scan_rot"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.volume.update_scan_rot">[docs]</a>            <span class="k">def</span> <span class="nf">update_scan_rot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan_rot_value</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scan_rot</span> <span class="o">=</span> <span class="n">scan_rot_value</span></div>
            
<div class="viewcode-block" id="MEDimage.scan.volume.update_transScanToModel"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.volume.update_transScanToModel">[docs]</a>            <span class="k">def</span> <span class="nf">update_transScanToModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transScanToModel_value</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">transScanToModel</span> <span class="o">=</span> <span class="n">transScanToModel_value</span></div>
            
<div class="viewcode-block" id="MEDimage.scan.volume.update_data"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.volume.update_data">[docs]</a>            <span class="k">def</span> <span class="nf">update_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_value</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data_value</span></div>

<div class="viewcode-block" id="MEDimage.scan.volume.convert_to_LPS"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.volume.convert_to_LPS">[docs]</a>            <span class="k">def</span> <span class="nf">convert_to_LPS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="sd">&quot;&quot;&quot;Convert Imaging data to LPS (Left-Posterior-Superior) coordinates system.</span>
<span class="sd">                &lt;https://www.slicer.org/wiki/Coordinate_systems&gt;.</span>

<span class="sd">                Returns:</span>
<span class="sd">                    None.</span>

<span class="sd">                &quot;&quot;&quot;</span>
                <span class="c1"># flip x</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="c1"># flip y</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>
            
<div class="viewcode-block" id="MEDimage.scan.volume.spatialRef_from_nifti"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.volume.spatialRef_from_nifti">[docs]</a>            <span class="k">def</span> <span class="nf">spatialRef_from_nifti</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nifti_image_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                <span class="sd">&quot;&quot;&quot;Computes the imref3d spatialRef using a NIFTI file and</span>
<span class="sd">                updates the `spatialRef` attribute.</span>

<span class="sd">                Args:</span>
<span class="sd">                    nifti_image_path (str): String of the NIFTI file path.</span>

<span class="sd">                Returns:</span>
<span class="sd">                    None.</span>

<span class="sd">                &quot;&quot;&quot;</span>
                <span class="c1"># Loading the nifti file:</span>
                <span class="n">nifti_image_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">nifti_image_path</span><span class="p">)</span>
                <span class="n">nifti</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">nifti_image_path</span><span class="p">)</span>
                <span class="n">nifti_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>

                <span class="c1"># spatialRef Creation</span>
                <span class="n">pixelX</span> <span class="o">=</span> <span class="n">nifti</span><span class="o">.</span><span class="n">affine</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                <span class="n">pixelY</span> <span class="o">=</span> <span class="n">nifti</span><span class="o">.</span><span class="n">affine</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                <span class="n">sliceS</span> <span class="o">=</span> <span class="n">nifti</span><span class="o">.</span><span class="n">affine</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
                <span class="n">min_grid</span> <span class="o">=</span> <span class="n">nifti</span><span class="o">.</span><span class="n">affine</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
                <span class="n">min_Xgrid</span> <span class="o">=</span> <span class="n">min_grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">min_Ygrid</span> <span class="o">=</span> <span class="n">min_grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">min_Zgrid</span> <span class="o">=</span> <span class="n">min_grid</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">size_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">nifti_data</span><span class="p">)</span>
                <span class="n">spatialRef</span> <span class="o">=</span> <span class="n">imref3d</span><span class="p">(</span><span class="n">size_image</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">pixelX</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">pixelY</span><span class="p">),</span> <span class="nb">abs</span><span class="p">(</span><span class="n">sliceS</span><span class="p">))</span>
                <span class="n">spatialRef</span><span class="o">.</span><span class="n">XWorldLimits</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">XWorldLimits</span><span class="p">)</span> <span class="o">-</span>
                                        <span class="p">(</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">XWorldLimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span>
                                            <span class="p">(</span><span class="n">min_Xgrid</span><span class="o">-</span><span class="n">pixelX</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
                                        <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="n">spatialRef</span><span class="o">.</span><span class="n">YWorldLimits</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">YWorldLimits</span><span class="p">)</span> <span class="o">-</span>
                                        <span class="p">(</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">YWorldLimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span>
                                            <span class="p">(</span><span class="n">min_Ygrid</span><span class="o">-</span><span class="n">pixelY</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
                                        <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="n">spatialRef</span><span class="o">.</span><span class="n">ZWorldLimits</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">ZWorldLimits</span><span class="p">)</span> <span class="o">-</span>
                                        <span class="p">(</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">ZWorldLimits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span>
                                            <span class="p">(</span><span class="n">min_Zgrid</span><span class="o">-</span><span class="n">sliceS</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
                                        <span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

                <span class="c1"># Converting the results into lists</span>
                <span class="n">spatialRef</span><span class="o">.</span><span class="n">ImageSize</span> <span class="o">=</span> <span class="n">spatialRef</span><span class="o">.</span><span class="n">ImageSize</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="n">spatialRef</span><span class="o">.</span><span class="n">XIntrinsicLimits</span> <span class="o">=</span> <span class="n">spatialRef</span><span class="o">.</span><span class="n">XIntrinsicLimits</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="n">spatialRef</span><span class="o">.</span><span class="n">YIntrinsicLimits</span> <span class="o">=</span> <span class="n">spatialRef</span><span class="o">.</span><span class="n">YIntrinsicLimits</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="n">spatialRef</span><span class="o">.</span><span class="n">ZIntrinsicLimits</span> <span class="o">=</span> <span class="n">spatialRef</span><span class="o">.</span><span class="n">ZIntrinsicLimits</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

                <span class="c1"># update spatialRef</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_spatialRef</span><span class="p">(</span><span class="n">spatialRef</span><span class="p">)</span></div>

<div class="viewcode-block" id="MEDimage.scan.volume.convert_spatialRef"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.volume.convert_spatialRef">[docs]</a>            <span class="k">def</span> <span class="nf">convert_spatialRef</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="sd">&quot;&quot;&quot;converts the `spatialRef` attribute from RAS to LPS coordinates system.</span>
<span class="sd">                &lt;https://www.slicer.org/wiki/Coordinate_systems&gt;.</span>

<span class="sd">                Args:</span>
<span class="sd">                    None.</span>

<span class="sd">                Returns:</span>
<span class="sd">                    None.</span>

<span class="sd">                &quot;&quot;&quot;</span>
                <span class="c1"># swap x and y data</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">ImageExtentInWorldX</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">ImageExtentInWorldX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">ImageExtentInWorldY</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">ImageExtentInWorldY</span> <span class="o">=</span> <span class="n">temp</span>

                <span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">PixelExtentInWorldX</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">PixelExtentInWorldX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">PixelExtentInWorldY</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">PixelExtentInWorldY</span> <span class="o">=</span> <span class="n">temp</span>

                <span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">XIntrinsicLimits</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">XIntrinsicLimits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">YIntrinsicLimits</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">YIntrinsicLimits</span> <span class="o">=</span> <span class="n">temp</span>

                <span class="n">temp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">XWorldLimits</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">XWorldLimits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">YWorldLimits</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spatialRef</span><span class="o">.</span><span class="n">YWorldLimits</span> <span class="o">=</span> <span class="n">temp</span>
                <span class="k">del</span> <span class="n">temp</span></div></div>

<div class="viewcode-block" id="MEDimage.scan.volume_process"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.volume_process">[docs]</a>        <span class="k">class</span> <span class="nc">volume_process</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Organizes all volume data and information. </span>

<span class="sd">            Attributes:</span>
<span class="sd">                spatialRef (imref3d): Imaging data orientation (axial, sagittal or coronal).</span>
<span class="sd">                scan_rot (ndarray): Array of the rotation applied to the XYZ points of the ROI.</span>
<span class="sd">                data (ndarray): n-dimensional of the imaging data.</span>

<span class="sd">            &quot;&quot;&quot;</span>
<div class="viewcode-block" id="MEDimage.scan.volume_process.__init__"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.volume_process.__init__">[docs]</a>            <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spatialRef</span><span class="p">:</span> <span class="n">imref3d</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                        <span class="n">scan_rot</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="n">user_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                <span class="sd">&quot;&quot;&quot;Organizes all volume data and information. </span>

<span class="sd">                Args:</span>
<span class="sd">                    spatialRef (imref3d, optional): Imaging data orientation (axial, sagittal or coronal).</span>
<span class="sd">                    scan_rot (ndarray, optional): Array of the rotation applied to the XYZ points of the ROI.</span>
<span class="sd">                    data (ndarray, optional): n-dimensional of the imaging data.</span>
<span class="sd">                    user_string(str, optional): string explaining the processed data in the class.</span>
<span class="sd">                </span>
<span class="sd">                Returns:</span>
<span class="sd">                    None.</span>

<span class="sd">                &quot;&quot;&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scan_rot</span> <span class="o">=</span> <span class="n">scan_rot</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">spatialRef</span> <span class="o">=</span> <span class="n">spatialRef</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">user_string</span> <span class="o">=</span> <span class="n">user_string</span></div>

<div class="viewcode-block" id="MEDimage.scan.volume_process.update_processed_data"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.volume_process.update_processed_data">[docs]</a>            <span class="k">def</span> <span class="nf">update_processed_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">user_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">user_string</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">user_string</span> <span class="o">=</span> <span class="n">user_string</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span></div>

<div class="viewcode-block" id="MEDimage.scan.volume_process.save"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.volume_process.save">[docs]</a>            <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name_save</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">path_save</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span><span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                <span class="sd">&quot;&quot;&quot;Saves the processed data locally.</span>

<span class="sd">                Args:</span>
<span class="sd">                    name_save(str): Saving name of the processed data.</span>
<span class="sd">                    path_save(Union[Path, str]): Path to where save the processed data.</span>
<span class="sd">                </span>
<span class="sd">                Returns:</span>
<span class="sd">                    None.</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="n">path_save</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path_save</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">name_save</span><span class="p">:</span>
                    <span class="n">name_save</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_string</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">name_save</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.npy&#39;</span><span class="p">):</span>
                    <span class="n">name_save</span> <span class="o">+=</span> <span class="s1">&#39;.npy&#39;</span>

                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path_save</span> <span class="o">/</span> <span class="n">name_save</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span></div>

<div class="viewcode-block" id="MEDimage.scan.volume_process.load"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.volume_process.load">[docs]</a>            <span class="k">def</span> <span class="nf">load</span><span class="p">(</span>
                    <span class="bp">self</span><span class="p">,</span> 
                    <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
                    <span class="n">loading_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> 
                    <span class="n">update</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
                <span class="sd">&quot;&quot;&quot;Saves the processed data locally.</span>

<span class="sd">                Args:</span>
<span class="sd">                    file_name(str): Name file of the processed data to load.</span>
<span class="sd">                    loading_path(Union[Path, str]): Path to the processed data to load.</span>
<span class="sd">                    update(bool, optional): If True, updates the class attrtibutes with loaded data.</span>

<span class="sd">                Returns:</span>
<span class="sd">                    None.</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="n">loading_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">loading_path</span><span class="p">)</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">file_name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.npy&#39;</span><span class="p">):</span>
                    <span class="n">file_name</span> <span class="o">+=</span> <span class="s1">&#39;.npy&#39;</span>

                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">loading_path</span> <span class="o">/</span> <span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">update</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">update_processed_data</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="MEDimage.scan.ROI"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.ROI">[docs]</a>        <span class="k">class</span> <span class="nc">ROI</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Organizes all ROI data and information. </span>

<span class="sd">            Attributes:</span>
<span class="sd">                indexes (Dict): Dict of the ROI indexes for each ROI name.</span>
<span class="sd">                roi_names (Dict): Dict of the ROI names.</span>
<span class="sd">                nameSet (Dict): Dict of the User-defined name for Structure Set for each ROI name.</span>
<span class="sd">                nameSetInfo (Dict): Dict of the names of the structure sets that define the areas of </span>
<span class="sd">                    significance. Either &#39;StructureSetName&#39;, &#39;StructureSetDescription&#39;, &#39;SeriesDescription&#39; </span>
<span class="sd">                    or &#39;SeriesInstanceUID&#39;.</span>
<span class="sd">            </span>
<span class="sd">            &quot;&quot;&quot;</span>
<div class="viewcode-block" id="MEDimage.scan.ROI.__init__"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.ROI.__init__">[docs]</a>            <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indexes</span><span class="p">:</span> <span class="n">Dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">roi_names</span><span class="p">:</span> <span class="n">Dict</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                <span class="sd">&quot;&quot;&quot;Constructor of the ROI class.</span>

<span class="sd">                Args:</span>
<span class="sd">                    indexes (Dict, optional): Dict of the ROI indexes for each ROI name.</span>
<span class="sd">                    roi_names (Dict, optional): Dict of the ROI names.</span>
<span class="sd">                </span>
<span class="sd">                Returns:</span>
<span class="sd">                    None.</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span> <span class="o">=</span> <span class="n">indexes</span> <span class="k">if</span> <span class="n">indexes</span> <span class="k">else</span> <span class="p">{}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roi_names</span> <span class="o">=</span> <span class="n">roi_names</span> <span class="k">if</span> <span class="n">roi_names</span> <span class="k">else</span> <span class="p">{}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nameSet</span> <span class="o">=</span> <span class="n">roi_names</span> <span class="k">if</span> <span class="n">roi_names</span> <span class="k">else</span> <span class="p">{}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nameSetInfo</span> <span class="o">=</span> <span class="n">roi_names</span> <span class="k">if</span> <span class="n">roi_names</span> <span class="k">else</span> <span class="p">{}</span></div>

<div class="viewcode-block" id="MEDimage.scan.ROI.get_indexes"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.ROI.get_indexes">[docs]</a>            <span class="k">def</span> <span class="nf">get_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span> <span class="ow">or</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="p">{}</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span></div>

<div class="viewcode-block" id="MEDimage.scan.ROI.get_roi_name"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.ROI.get_roi_name">[docs]</a>            <span class="k">def</span> <span class="nf">get_roi_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">roi_names</span> <span class="ow">or</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="p">{}</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">roi_names</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span></div>

<div class="viewcode-block" id="MEDimage.scan.ROI.get_name_set"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.ROI.get_name_set">[docs]</a>            <span class="k">def</span> <span class="nf">get_name_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">nameSet</span> <span class="ow">or</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="p">{}</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nameSet</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span></div>

<div class="viewcode-block" id="MEDimage.scan.ROI.get_name_set_info"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.ROI.get_name_set_info">[docs]</a>            <span class="k">def</span> <span class="nf">get_name_set_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">nameSetInfo</span> <span class="ow">or</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">return</span> <span class="p">{}</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nameSetInfo</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span></div>

<div class="viewcode-block" id="MEDimage.scan.ROI.update_indexes"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.ROI.update_indexes">[docs]</a>            <span class="k">def</span> <span class="nf">update_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">indexes</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span> 
                    <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span> <span class="o">=</span> <span class="n">indexes</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="ne">Warning</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Wrong key given in update_indexes()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MEDimage.scan.ROI.update_roi_name"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.ROI.update_roi_name">[docs]</a>            <span class="k">def</span> <span class="nf">update_roi_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">roi_name</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">roi_names</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span> <span class="o">=</span> <span class="n">roi_name</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="ne">Warning</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Wrong key given in update_roi_name()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MEDimage.scan.ROI.update_name_set"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.ROI.update_name_set">[docs]</a>            <span class="k">def</span> <span class="nf">update_name_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">name_set</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nameSet</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span> <span class="o">=</span> <span class="n">name_set</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="ne">Warning</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Wrong key given in update_name_set()&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MEDimage.scan.ROI.update_name_set_info"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.ROI.update_name_set_info">[docs]</a>            <span class="k">def</span> <span class="nf">update_name_set_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">nameSetInfo</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nameSetInfo</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span> <span class="o">=</span> <span class="n">nameSetInfo</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="ne">Warning</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Wrong key given in update_name_set_info()&quot;</span><span class="p">)</span></div>
            
<div class="viewcode-block" id="MEDimage.scan.ROI.convert_to_LPS"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.ROI.convert_to_LPS">[docs]</a>            <span class="k">def</span> <span class="nf">convert_to_LPS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
                <span class="sd">&quot;&quot;&quot;Converts the given volume to LPS coordinates system. For </span>
<span class="sd">                more details please refer here : https://www.slicer.org/wiki/Coordinate_systems</span>
<span class="sd">                Args:</span>
<span class="sd">                    data(ndarray) : Volume data in RAS to convert to to LPS</span>

<span class="sd">                Returns:</span>
<span class="sd">                    ndarray: n-dimensional of `data` in LPS.</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="c1"># flip x</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="c1"># flip y</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="MEDimage.scan.ROI.get_roi_from_path"><a class="viewcode-back" href="../../MEDimage.html#MEDimage.MEDimage.MEDimage.scan.ROI.get_roi_from_path">[docs]</a>            <span class="k">def</span> <span class="nf">get_roi_from_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">roi_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
                <span class="sd">&quot;&quot;&quot;Extracts all ROI data from the given path for the given</span>
<span class="sd">                patient ID and updates all class attributes with the new extracted data.</span>

<span class="sd">                Args:</span>
<span class="sd">                    roi_path(Union[Path, str]): Path where the ROI data is stored.</span>
<span class="sd">                    id(str): ID containing patient ID and the modality type, to identify the right file.</span>
<span class="sd">                </span>
<span class="sd">                Returns:</span>
<span class="sd">                    None.</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">indexes</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roi_names</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nameSet</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nameSetInfo</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">roi_index</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">list_of_patients</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">roi_path</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">list_of_patients</span><span class="p">:</span>
                    <span class="c1"># Load the patient&#39;s ROI nifti files :</span>
                    <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span> <span class="ow">and</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;nii.gz&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="s1">&#39;ROI&#39;</span> <span class="ow">in</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">):</span>
                        <span class="n">roi</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">roi_path</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">file</span><span class="p">)</span>
                        <span class="n">roi_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">convert_to_LPS</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">roi</span><span class="o">.</span><span class="n">get_fdata</span><span class="p">())</span>
                        <span class="n">roi_name</span> <span class="o">=</span> <span class="n">file</span><span class="p">[</span><span class="n">file</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span> <span class="p">:</span> <span class="n">file</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">)]</span>
                        <span class="n">name_set</span> <span class="o">=</span> <span class="n">file</span><span class="p">[</span><span class="n">file</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span> <span class="p">:</span> <span class="n">file</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">update_indexes</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">roi_index</span><span class="p">,</span> <span class="n">indexes</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">roi_data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">update_name_set</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">roi_index</span><span class="p">,</span> <span class="n">name_set</span><span class="o">=</span><span class="n">name_set</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">update_roi_name</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">roi_index</span><span class="p">,</span> <span class="n">ROIname</span><span class="o">=</span><span class="n">roi_name</span><span class="p">)</span>
                        <span class="n">roi_index</span> <span class="o">+=</span> <span class="mi">1</span></div></div></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, MEDimage.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>